<?xml version="1.0" encoding="UTF-8"?>
<ContentPage
    x:Class="MauMind.App.Views.ChatPage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    Title="Chat"
    Background="{AppThemeBinding Light={StaticResource LightBackground}, Dark={StaticResource DarkBackground}}">

    <Grid RowDefinitions="Auto,*,Auto">
        <!-- Premium Minimal Header -->
        <Grid Grid.Row="0" Margin="20,16,20,8" HeightRequest="56">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>
            
            <!-- Brand Avatar - Premium Gradient -->
            <Frame Grid.Column="0" WidthRequest="40" HeightRequest="40" CornerRadius="20"
                   Background="{StaticResource Primary}" Padding="0">
                <Label Text="M" FontSize="18" FontAttributes="Bold" TextColor="White"
                       HorizontalOptions="Center" VerticalOptions="Center"/>
            </Frame>
            
            <!-- Title & Status -->
            <StackLayout Grid.Column="1" VerticalOptions="Center" Margin="14,0,0,0">
                <Label Text="MauMind" Style="{StaticResource CardTitle}"
                       TextColor="{AppThemeBinding Light={StaticResource LightTextPrimary}, Dark={StaticResource DarkTextPrimary}}"/>
                <StackLayout Orientation="Horizontal" Spacing="6">
                    <Frame WidthRequest="6" HeightRequest="6" CornerRadius="3" 
                           Background="{StaticResource Success}" Padding="0" VerticalOptions="Center"/>
                    <Label Text="Ready" Style="{StaticResource CaptionText}"
                           TextColor="{AppThemeBinding Light={StaticResource LightTextSecondary}, Dark={StaticResource DarkTextSecondary}}"/>
                </StackLayout>
            </StackLayout>
            
            <!-- Settings Icon - Clean -->
            <Button Grid.Column="2" Text="&#x2699;" FontSize="20" Style="{StaticResource IconButton}" 
                    BackgroundColor="Transparent" Clicked="OnSettingsClicked"
                    TextColor="{AppThemeBinding Light={StaticResource Gray500}, Dark={StaticResource Gray400}}"/>
        </Grid>

        <!-- Chat Messages Area -->
        <ScrollView Grid.Row="1" VerticalScrollBarVisibility="Always" Padding="20,8">
            <StackLayout x:Name="MessagesStack" Spacing="16">
                <!-- Empty State - Premium Minimal -->
                <StackLayout x:Name="ChatEmptyState" 
                             VerticalOptions="Center" 
                             HorizontalOptions="Center" 
                             Margin="0,60,0,0"
                             Spacing="20">
                    <StackLayout HorizontalOptions="Center" Spacing="8">
                        <Label Text="What can I help you with?" 
                               Style="{StaticResource Heading}"
                               HorizontalOptions="Center"/>
                        
                        <Label Text="Ask questions about your documents&#x0a;or start a conversation" 
                               Style="{StaticResource BodySecondary}"
                               HorizontalOptions="Center" 
                               HorizontalTextAlignment="Center"/>
                        
                        <!-- Quick Actions - Premium Design -->
                        <StackLayout Margin="0,24,0,0" Spacing="8">
                            <Button Text="Summarize my notes" 
                                    Style="{StaticResource SecondaryButton}"
                                    HorizontalOptions="Center"
                                    Clicked="OnSampleQuestionClicked"/>
                            <Button Text="Start writing" 
                                    Style="{StaticResource PrimaryButton}"
                                    HorizontalOptions="Center"
                                    Clicked="OnSampleQuestionClicked"/>
                        </StackLayout>
                    </StackLayout>
                </StackLayout>
            </StackLayout>
        </ScrollView>

        <!-- Premium Input Bar - Clean Design -->
        <Grid Grid.Row="2" Margin="20,8,20,24">
            <Frame CornerRadius="24" Padding="6"
                   Background="{AppThemeBinding Light={StaticResource LightSurface}, Dark={StaticResource DarkSurfaceElevated}}"
                   BorderColor="{AppThemeBinding Light={StaticResource LightBorder}, Dark={StaticResource DarkBorder}}">
                <Grid ColumnDefinitions="Auto,*,Auto,Auto">
                    <!-- Voice Input -->
                    <Button Grid.Column="0"
                            x:Name="VoiceButton"
                            Text="&#x1F3A4;"
                            FontSize="16"
                            Clicked="OnVoiceClicked"
                            BackgroundColor="Transparent"
                            TextColor="{StaticResource Primary}"
                            WidthRequest="40"
                            HeightRequest="40"
                            CornerRadius="20"/>
                    
                    <!-- Text Input -->
                    <Entry Grid.Column="1"
                           x:Name="MessageEntry"
                           Text="{Binding UserInput, Mode=TwoWay}"
                           Placeholder="Type a message..."
                           VerticalOptions="Center"
                           BackgroundColor="Transparent"
                           FontSize="15"
                           TextColor="{AppThemeBinding Light={StaticResource LightTextPrimary}, Dark={StaticResource DarkTextPrimary}}"
                           PlaceholderColor="{AppThemeBinding Light={StaticResource LightTextTertiary}, Dark={StaticResource DarkTextTertiary}}"
                           Margin="4,0"/>
                    
                    <!-- Cancel Button (shown when processing) -->
                    <Button Grid.Column="2"
                            Text="&#x2715;"
                            FontSize="12"
                            Clicked="OnCancelClicked"
                            IsVisible="{Binding IsProcessing}"
                            BackgroundColor="{StaticResource ErrorLight}"
                            TextColor="{StaticResource Error}"
                            WidthRequest="32"
                            HeightRequest="32"
                            CornerRadius="16"
                            Margin="4,0"/>
                    
                    <!-- Send Button -->
                    <Button Grid.Column="3"
                            x:Name="SendButton"
                            Text="&#x27A4;"
                            FontSize="16"
                            Clicked="OnSendClicked"
                            BackgroundColor="{StaticResource Primary}"
                            TextColor="White"
                            WidthRequest="40"
                            HeightRequest="40"
                            CornerRadius="20"
                            Margin="4,0,0,0"/>
                </Grid>
            </Frame>
        </Grid>
    </Grid>

</ContentPage>
